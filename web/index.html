<html>
  <head>
    <style>
    .progressBar {
      width: 500px;
      background-color: lightgray;
    }
    .progress {
      width: 1%;
      height: 30px;
      background-color: lightgreen;
    }
    .recorderLight {
      width: 50px;
      height: 50px;
      border: 1px solid black;
    }
    .recording {
      background-color: red;
    }
    </style>

    <script src="jquery-3.3.1.js"></script>
    <script src="vexflow-debug.js"></script>
    <script src="PracticeTools.js"></script>
    <script>
      $(() => {
        PT = PracticeTools(Vex.Flow, jQuery);

        var interface = PT.MIDIInterface();
        var scheduler = PT.Scheduler();
        var metronome = PT.Metronome(interface, scheduler);
        var filter = PT.AccuracyFilter(scheduler, interface.event);
        var skillmeter = PT.SkillMeter(interface, filter.hitevent, filter.missevent);
        //var recorder = PT.Recorder(interface, scheduler, script => looper.play(script));
        //var looper = PT.Looper(interface, scheduler);

        filter.missevent.listen(() => {
          interface.sendMIDI([ 0x90, 30, 64 ]);
          scheduler.schedule(scheduler.now() + 0.05, () => {
            interface.sendMIDI([ 0x90, 30, 0 ]);
          });
        });

        //filter.noteevent.listen(msg => interface.sendMIDI(msg.data));

        $('#container').append(
          interface.widget,
          scheduler.widget,
          metronome.widget,
          filter.widget,
          skillmeter.widget,
          //recorder.widget,
          //looper.widget,
        );
      });
    </script>
  </head>
  <body>
    <div id="container"></div>
  </body>
</html>
